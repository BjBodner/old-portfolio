function [Y,Xf,Af] = NN_133Binance_10Neurons(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 16-Feb-2018 12:04:31.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 170xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 10xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.813037037037037;0.76078431372549;0.440336461843484;0.686274509803922;0.419607843137255;0.396078431372549;0.392156862745098;0.256403826582536;0.251684857257013;0.158495420313454;0.228956645634032;0.242421331162223;0.392156862745098;0.431372549019608;0.172680974888994;0.556862745098039;0.865362914716059;0.823328523720138;0.454901960784314;0.0941354984131292;0.323216560749636;0.073880664299553;0.0621360411907939;0.0603086294110108;0.0485096682271524;0.0410986423019804;0.0567619995326081;0.0357451658864238;0.0603086294110108;0.0603086294110108;0.0802707857460555;0.0585174028088744;0.388235294117647;0.908804185418881;0.908804185418881;0.380392156862745;0.0550420577304355;0.0550420577304355;0.0397134133930389;0.0603086294110108;0.0567619995326081;0.064;0.0698147771219214;0.0550420577304355;0.0517071111412654;0.0567619995326081;0.0567619995326081;0.0397134133930389;0.0824799511500102;0.435294117647059;0.886906242697002;0.813037037037037;0.356862745098039;0.0454468341738849;0.0485096682271524;0.073880664299553;0.0698147771219214;0.0485096682271524;0.0357451658864238;0.073880664299553;0.104213311622227;0.0439649908406269;0.0425157141672509;0.0802707857460555;0.0621360411907939;0.0485096682271524;0.364705882352941;0.897810706289436;0.865362914716059;0.345098039215686;0.0410986423019804;0.0469616060188012;0.0567619995326081;0.0870191404512593;0.0533572155505801;0.0533572155505801;0.0357451658864238;0.064;0.0439649908406269;0.0759715041726033;0.220263036087176;0.0439649908406269;0.0383596655886499;0.337254901960784;0.833706492977814;0.844171306661842;0.301960784313725;0.027532879510897;0.032050478322817;0.0344836902850337;0.0718285425665845;0.0517071111412654;0.0469616060188012;0.0485096682271524;0.0517071111412654;0.0585174028088744;0.0410986423019804;0.0550420577304355;0.0264740409043279;0.0425157141672509;0.349019607843137;0.813037037037037;0.833706492977814;0.356862745098039;0.0454468341738849;0.0344836902850337;0.0550420577304355;0.0567619995326081;0.0621360411907939;0.0485096682271524;0.0410986423019804;0.073880664299553;0.0533572155505801;0.0533572155505801;0.0357451658864238;0.0357451658864238;0.073880664299553;0.419607843137255;0.897810706289436;0.844171306661842;0.352941176470588;0.0439649908406269;0.109511304098725;0.0678390061137873;0.0718285425665845;0.0383596655886499;0.0567619995326081;0.032050478322817;0.0397134133930389;0.0485096682271524;0.0397134133930389;0.0425157141672509;0.064;0.0870191404512593;0.443137254901961;0.813037037037037;0.833706492977814;0.6;0.216;0.40073106120572;0.407843137254902;0.233387942797265;0.169058416446163;0.114985880242139;0.12647636278656;0.12063993486668;0.114985880242139;0.099089007998432;0.291098235218732;0.4;0.443137254901961;0.833706492977814;0.833706492977814;0.854723326623998;0.76078431372549;0.440336461843484;0.733775094043769;0.749019607843137;0.42022274992273;0.426857724404641;0.256403826582536;0.251684857257013;0.158495420313454;0.228956645634032;0.242421331162223;0.623529411764706;0.556862745098039;0.172680974888994;0.556862745098039;0.865362914716059];
x1_step1.gain = [7.00968606041476;5.90405030672216;3.03962458826166;4.8601610282094;2.94083638114669;2.84380984573813;2.83123871128199;2.37164055488685;2.37034842138942;2.1413166342099;2.30180694221725;2.33814248049486;2.83594158427042;3.0145156495088;2.16773527304359;3.69614545431788;8.52580445544032;7.31859800237328;3.13352561003551;1.99035502586671;2.58528585096279;1.95158642745355;1.96249593987279;1.93194895810145;1.90277355744161;1.89256889271101;1.92604479522165;1.88714705170179;1.93633418348533;1.92733841424009;1.96949149663795;1.92880639276437;2.81526939830809;10.4877579013681;10.5286094724553;2.78408558763357;1.91414853917569;1.9184745042533;1.89912393318374;1.94701025515748;1.92473990696483;1.94678689754753;1.95418788253752;1.92195248780533;1.92236523827848;1.92576102654971;1.92992432632924;1.89475876318148;1.96928278166439;3.01073971489888;9.40048103503306;7.02231613420337;2.69210031410482;1.9060653017838;1.90589466368245;1.95444533303242;1.95403390521239;1.91882921373822;1.88329314583555;1.95791479255546;2.01587493683234;1.89620121448319;1.90230344440433;1.9755955853582;1.92707109174403;1.90588410016371;2.72409956400052;9.92839758136309;8.63488167872538;2.65525988369036;1.89363931312486;1.90053201395126;1.91872861816993;1.97837229501955;1.91899837464193;1.9159617478577;1.88807054728952;1.93364933138484;1.90174751250359;1.96443833338395;2.27925398155789;1.89537759924907;1.88735248569182;2.62325759818305;7.51229695178391;7.88588710271195;2.50678957959639;1.86889848256771;1.87631754561404;1.89450168296759;1.94886652092374;1.90913110805922;1.91646348106912;1.90980633719392;1.91870887392154;1.9306954306849;1.89585752154258;1.92493816482489;1.86788366905848;1.9004189388748;2.66501968451;6.99090125469146;7.54798135991674;2.69138934405405;1.90903115329481;1.9713833559237;1.93335736673689;1.92285312705761;1.94952949902375;1.98493239129088;1.89547660997838;1.95232749230578;1.92582740312981;1.91465715864266;1.88533661167464;1.88537518616111;1.96155087829566;2.94374807241693;9.89814850085464;7.82472876693075;2.68058889021887;1.90233813673554;2.02035699202253;1.94142730562955;1.96231118701226;1.89354800469563;1.92911618843055;1.90019554733081;1.90261260151916;1.90238936708989;1.88991372548132;1.89279109365127;1.94158064053237;1.97759722300798;3.04542819376191;6.96961229885949;7.53227733534504;4.00798500099886;2.26335713637102;2.86737199282264;2.90292688740016;2.32868769263222;2.15199502275167;2.04676647735741;2.06977710696617;2.05748493550433;2.0381092439473;2.00690893641721;2.49088070655848;2.85746817937672;3.068018180216;7.51686349544248;7.52508725830133;8.20326246969749;5.91786565535961;3.03526345290762;5.48635389865843;5.71212624591232;2.96333673599616;2.97283567771881;2.38507627556558;2.36305367924318;2.12812487643918;2.30799603369033;2.3369707039101;4.22039914522826;3.69571215867586;2.15706168575944;3.68562462762322;8.57258142046622];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3023376465670895;-0.88818463255109203;-0.70191943710973925;-0.53276189526774431;0.012078275486290525;-0.1809844433125169;-0.4909078050475037;-0.80438728583136232;-1.061164758633365;-1.350785458594074];
IW1_1 = [-0.22521253057302065 -0.018594782684910695 -0.17794320171312275 0.077218094263177814 0.12240317132616164 -0.27453357902483916 -0.16254291806669019 -0.57463366390905646 -0.72360080592909792 -0.2603610175493869 -0.22751642386345844 -0.098350665072674426 -0.026559116684135485 -0.39593965618041999 -0.014736578595358535 -0.075328806678907595 -0.045940195018804045 0.19340542956334716 0.029919011200373088 -0.18732308525804744 0.23421212813789608 0.15449895818678189 0.24039939684721151 -0.28105358445606349 -0.1953034224375764 -0.38321391717331332 -0.1607464653366957 -0.31543846008281423 -0.0045881403539472379 0.10288995982763362 -0.05099009786985869 -0.19843983364869816 -0.21643126062748722 0.063573910766098793 0.028353490079417967 0.19117184104208351 0.017899499917478238 -0.11107295333424738 0.12179964672044864 0.2861599277923873 0.56169846496465337 0.31443464694740669 0.21033985604732261 0.059894359437739991 0.19397687071434738 -0.077592357454739996 0.035994033516468668 0.069332478647148449 -0.096596869277689623 -0.056782459229921582 0.056607776847543985 0.064978031488510279 -0.19693775101725142 -0.25615956321438449 -0.088936181065745551 -0.24462411709402077 0.11632453522421334 0.057427963226861264 0.4108017945375691 0.03064452519548172 0.33011714263742525 0.21346579615755051 -0.41608324247320966 -0.39818082858807669 -0.27684311630822894 -0.091857014189055924 -0.13757872750318861 0.26114744250168104 0.12708237885927734 -0.2322754493726148 -0.28386946298746329 -0.0075788964756465585 0.081993711551027706 0.052924139128344337 -0.0092336646769507827 0.18181513454745304 0.25144714714674532 -0.017105761130812479 0.23187913254787262 0.16628079915904995 0.20508974039068148 -0.11831495103357367 -0.25696570897475046 -0.045090851846159512 0.20708601453719183 0.21870551690144097 0.091435003826819808 -0.02345301432490985 0.11690261206520149 -0.10170112454488665 0.11388578251364251 0.30246173563644585 0.034124243155188562 0.19202897475019218 0.1310631453286264 0.23618849914444762 0.34898216482201067 0.29704510089836478 0.19567158694063599 0.021052133496862625 0.044293055597223116 0.048890336482005387 -0.017191174691461548 -0.045613927976045097 -0.26177415211722727 0.19367239445069173 0.038840673167667955 0.191597581218203 0.0020205639525574135 0.24680197271179868 0.20307924805199909 0.46085726112926584 0.39944937138165698 0.30327197589768828 0.19807356383773017 -0.10871235694224976 0.018891360493682448 0.05241199740105644 0.24273013558330872 -0.10851872503070976 -0.2366620883562548 -0.38370838748934621 -0.19599418394509971 -0.31741642594735209 -0.20319714828669028 0.040906451671735233 -0.17018320261058587 -0.15881603260915253 0.031746375203661997 0.089291268000174395 0.13829765188595058 -0.15016643238235056 0.029960407296246678 0.13508533271595044 0.070361113050982083 0.086896292574133657 0.071492583621778572 -0.379043095273492 -0.12584593233595814 -0.15975052739195014 -0.21495649035899256 -0.0099801610220351718 0.020320828086958127 -0.1514029736602161 -0.1860064094322352 -0.067498741642349369 0.018530345216465814 -0.053766789894574001 -0.11567893286343393 0.079755664665786402 0.14620987006262767 0.053466810149921495 -0.2130366215649073 -0.10446035380380479 0.13384908044832655 0.056949029318889989 -0.13218553835331015 0.034803922415951885 0.16669479693636258 -0.055706673827001646 0.049890452286054598 0.0077749209545707604 -0.14123758438773718 0.10898210634778338 0.031787093203165875 0.28410929157729331 0.10932639986182444 -0.26424494083637312 -0.021767825459549816 -0.089032206296504712;0.31246632687363807 -0.085315445317747068 -0.11823259097650413 -0.011690423137849255 0.0011905442792306846 0.21204657522473283 -0.18983030032382123 0.03428955033263098 -0.10104721387544069 -0.12967753705894194 -0.17773804389213654 0.0074708487232208534 0.0096240713542316905 -0.40655204597053485 0.18306197611078973 -0.08418190548671084 0.072084602968906897 -0.011963896957539473 0.018946166688186418 0.08249076421351606 -0.056814792904647096 -0.046199042726546638 0.20587120720615107 -0.064244827013380246 0.09023784199886431 -0.03112398764411051 -0.21605620109642343 -0.082111113791823648 -0.091013332737254218 0.045556019533458329 -0.20864636034995099 -0.48561047632381488 0.011253701160871916 -0.18828244207529754 -0.069681206392715911 -0.047151046551918985 0.19622528357367564 -0.03299456799538452 0.21457944048615607 -0.034355886179362076 -0.26310146029589698 -0.57943517058159855 -0.22016553906577963 -0.4580478375526526 -0.38774571943723257 -0.15884985765881512 -0.13455428401319072 -0.083509046932616543 -0.290181140270444 -0.068415423842353121 -0.095645005624791057 -0.074153767921667918 0.18697990964580916 -0.14694311282482808 0.26104784638105 0.17073280142379937 0.09095857165767128 -0.31788189677395917 -0.53238025359943475 -0.1916241801762843 -0.16916834220496996 -0.23205000425719502 -0.13388453085103011 0.034657558829215541 0.24709157869870813 0.1382714989214035 0.052515825023518398 0.033419166965954317 -0.1145966468322218 0.30944261876367701 -0.13186426061838452 0.32971165736389363 0.087965089521208809 0.35064821130698981 -0.16784831485165819 -0.14800263766983399 -0.086874773903484942 0.034572646742672103 -0.15185253420858086 -0.13355968375232646 0.13576565830723911 0.25076333960676472 -0.020164884453488571 0.1023587389323047 0.15696996863726234 -0.012493171939016452 0.10182045135604784 0.20295713038273785 0.28434469389200229 0.30368470776265366 0.29782223250799128 -0.18424055692091504 -0.18919917923840021 -0.21240058567599623 -0.42050833604114612 -0.30266268811606556 0.11929684412721384 0.39860430100423194 0.11449598358552439 0.0037280898486647526 -0.030240444073511865 0.012856837394986239 0.13080388551010208 0.10462707426996619 0.011730453119636509 -0.090891106079804884 0.23470557294578182 0.44153236881456792 0.18994855280066938 -0.32829106298797811 -0.31984762383933779 -0.23540191990790396 -0.37372186367276572 0.25469850035705949 0.45840906974574974 0.13881379035752384 -0.14125842101957214 0.018955910914192371 -0.14315750292702775 -0.12618569290037587 0.30731193065998902 0.24713856044405647 -0.0728466939927402 -0.26021265335621629 0.29463398033977328 0.2184672115756284 0.31016161665864705 -0.047327869958765804 0.010078725951427003 -0.029719261431234566 0.36150611552052986 0.36167016589374723 0.1031975119961873 -0.024286966343985496 -0.028577198006237314 0.057745219890566593 -0.18656778889692732 0.19043354024536449 0.046488530493800612 0.073231304848582493 -0.26192105084350226 0.14936668186190971 0.10348352200130291 0.48454318333543911 0.14981806938581863 0.37573249868855152 0.13454025492519892 -0.0059524265863150246 0.089209540642218171 -0.16799735340210811 -0.18794268934672981 -0.093178525795429845 -0.22733078195303727 0.046924192480295328 0.062807288883527865 0.093649904707185497 -0.068737726303531685 0.18210300526140069 0.16042254009009424 0.30267060101443272 0.33165188641744003 0.29870793668961337 0.18761698824434975 0.12833023978484503 -0.13280210359725106 -0.25852373205940737 0.2597395149618581 0.10218325664328631 0.058279652886658394 0.058223798683262537;0.0028609865163492084 0.12463752360171847 0.06829337186227305 -0.021952295244696125 0.23101635177300653 0.14531054787521028 0.0063131947565673906 0.07779402235701495 -0.13319499362864154 -0.35303403972511826 -0.42040908239390029 -0.1779568409918722 -0.14205921374701355 -0.02771737087579694 0.17472241106425374 0.24091574874477928 -0.18167226105537485 -0.013328711809174299 -0.16155750079315384 0.025765500250284568 -0.042983212062454111 0.21108329092757744 0.11007984153814156 0.27035472511579828 0.10724339711012759 0.13787848409870621 -0.10858259518696103 -0.54854325451182329 -0.51477056985927439 0.28475434280319945 0.14713550598149483 0.24716558274244685 0.31244628332017294 -0.016058300465914839 0.23486642748920322 0.15451301295329573 -0.014394878680274592 0.031694950631216939 0.031897763156662533 -0.00018471833497983418 0.012256841937654011 -0.12847276826917009 -0.19199966543364722 -0.12368756908921572 -0.30610247939224322 -0.25201707005021246 0.21609903536513198 0.16956219120258226 0.019027280091067363 0.049081052596117572 -0.17244339377913143 -0.039255461026840709 -0.26383905449212236 -0.18381401494063779 0.085671525525480421 -0.088280553361864661 0.34549607127524623 -0.10931117031536325 -0.43163634218232866 -0.23389250778762338 -0.21059085145233264 -0.084462110406652191 0.1056348553381565 0.020718011978076087 0.016616897187784307 0.10341705763692352 0.085469800553302111 -0.069148274488787562 0.14180942430364588 0.073333717806403548 -0.2628226237288539 -0.22116471418864375 0.21639590118216626 0.06805026802621765 -0.31942211287314803 -0.21644049207663466 -0.42492357740694009 -0.045542525412664348 0.10854191502107739 -0.20050547957086959 -0.14473765350812581 0.067274079726068761 0.095751418128394841 -0.029759959096291633 0.08230692806790435 0.096268245035237177 -0.069458430568012236 0.030463921245358728 0.055408279089373756 0.1504260113253339 -0.337975357039418 -0.34711016532070932 0.0058650839973303226 -0.33917792130564534 0.03157107173742512 0.23288640555684098 0.20109272558697358 0.068236735668843959 0.35658743166104712 0.38723042765040894 0.35447570925915767 0.17131728498927909 -0.13573686991637005 -0.078518649274087457 -0.33609427205234599 0.17681901784483584 -0.16121996005471773 -0.27835952447556689 -0.37015818980508658 0.076109153353733652 -0.010175712962029494 -0.051964814391055748 -0.052043823852657503 -0.11564009420807451 0.14196684922843511 0.43648255037740863 -0.019940634579145647 0.016332959838756884 -0.15793947906591491 -0.13946709244509536 -0.022956563494661658 -0.11329038724506175 -0.1735932994793829 -0.23155673938275731 -0.12313671935324101 0.24600152623872401 0.32993759095540748 0.26247385535152645 -0.025523316656903411 -0.31462664746944596 -0.38851437339246786 -0.0069185758567612415 -0.060406220071094911 -0.093022415672856296 0.15648966885479867 0.015449670168721981 -0.21220055159225218 -0.044447078170763189 -0.06269248862851505 -0.12182808848074671 -0.16947197963154259 0.14021341650851035 0.45622095746519292 0.41511720624320264 0.32687799046588589 0.1613713909790031 -0.24142301464885998 -0.24833112391875067 -0.14680569307971256 -0.21900248311910769 0.26458929842061896 0.14021551798287871 0.027750247911499208 0.029398517996214089 0.11796219941585802 0.10787517936231182 -0.048283301838383565 0.085552975218123412 0.25788367204491308 0.2967239791944758 0.21564348830513108 0.21675972042933714 0.084009227478361773 0.055917109772472912 -0.0062239008869422272 0.23090918180349956 -0.11640044202112851 0.28362844950954741 0.090573350164903282 0.10186649159866484;-0.034741607709217227 -0.14623856564845025 -0.18334012719245013 -0.065211753086201849 -0.052824640279408752 0.059492352589579182 0.19857390054294494 0.046779382589102962 0.15879475024588044 0.066431086148842522 0.013730442505003763 0.015241767743538212 -0.1104305319511787 -0.065689350836405105 0.079088243160401431 0.034810992830304886 -0.22008142529209235 -0.08415307860529167 -0.21167821477290638 0.037568425064801722 -0.0040092628147750361 -0.12655095607438099 0.14671973919570033 0.35433345601892408 0.28744335991714715 0.40514732662014663 0.21025459861387866 0.46094468013362216 0.12838869681099629 0.067415335532278284 -0.18900011722664606 0.0059593474851734442 -0.051201605474889091 -0.11574128071081856 0.21607286148150018 -0.28631315090240655 -0.32386592651840446 0.022701012171659735 -0.18185881348706481 0.15190334262189323 0.12494606144457815 0.36865246590301226 0.24031792627619372 0.33449199707796884 0.32296625719823885 0.050217345260274653 -0.069827213365823676 -0.29385830078358455 -0.18124841686139048 0.082239971556669511 0.1794297388740653 -0.066955722472947024 0.061523320389016818 -0.19770055968336278 -0.19652904076201322 -0.00037919981324113398 0.27048273524691546 0.23778325477677084 0.26244003174081937 -0.027672233682639463 0.18966756454975292 -0.0071814420492810008 0.14327127068380971 -0.088935218818863362 -0.23806189701818259 -0.014743931559339851 -0.11751728526230119 -0.16273435967344252 -0.012604194129443008 -0.038994183905038345 -0.023680809508557648 -0.041218056718401681 0.028974147786366873 0.019035791070783292 -0.037986310366326152 0.017375964130451841 -0.30579605786884556 -0.26878999355027544 0.012268070527859585 0.072159948497244775 0.052993158615905638 -0.0043465071855426042 -0.15097204052705124 -0.017473578091733121 0.20269918019353478 -0.013940297215663875 0.015318593061949055 -0.17731708487406606 0.017787247657827292 -0.2001830853835149 0.091040696445697816 0.15336214027298831 -0.18564478409441088 -0.39570241391698585 0.027280266061206097 -0.063731691385165407 0.21696426328053442 0.15426008247586931 0.15348811626617986 -0.081900709750134193 -0.25657573547693413 -0.058975266185274856 0.14550685511676958 -0.18053531027427447 -0.28027462850043844 -0.070636405907206185 -0.11267259885053446 -0.15919191480616879 -0.31236533202686784 -0.15215219293772639 -0.091159234117838717 0.15033500390368995 0.15757975536009236 0.33192147687261836 0.32090800608683395 -0.027304688436150571 0.13520910728796598 -0.2392190943780507 0.018533974630720165 -0.1440662848974216 0.065074931000253008 -0.20720005468037014 0.17903232532573776 -0.34016020790362506 -0.33446247094777576 -0.19241627336241465 -0.043532422440655187 0.12026804232364849 0.17143640653156564 -0.12595221301852216 0.034293815621721242 0.074314075249508976 0.13940248325277832 -0.14628410116798995 0.006536079734025254 0.13038097528299347 -0.013741249359247568 0.094508200673231929 -0.077369127769039509 -0.033901337737481031 0.010061605540501006 -0.081164636944278168 0.021489348008183046 0.075808651967297941 0.25045280157587546 -0.14639471576015592 -0.031521501183256563 -0.072458085457481169 -0.28316716982887813 0.050322634013081485 0.022620809530846407 -0.072530885678317211 0.096570898383286377 0.071762969365166421 0.21141356031958899 -0.16514499088204196 0.18969410060081621 -0.16503900436529695 -0.095542364006948183 0.077012592567898858 -0.067458317222195655 0.16081090626390313 -0.0050867609920037665 -0.061927034377589674 -0.033828611621496973 -0.18525589094848915 -0.01668950628880296 0.086428672663340186 0.086984169089436597 0.062401157776088532;-0.12136956251316318 -0.0076108456860270804 -0.12747085640222974 0.043547597071713427 -0.29963870986113667 -0.25821538299876967 0.087443359500992801 0.12605059591895795 0.0040630191853639145 0.055835293346675426 -0.220460509215263 0.057689181882797959 0.014039657513074455 -0.077921122520569527 -0.17468518753576373 0.033319868342052084 0.069163371114443789 0.0015943661613785115 -0.19884298719799304 -0.10983427922424388 -0.11699071706928475 -0.33779356253085119 -0.096958235978949425 0.2022790878623229 0.64871085515367422 0.32757292396356547 -0.19008196970320992 -0.54159790700851929 -0.33093596781973511 -0.24444165777127508 -0.17296293884073669 -0.10125668235525374 -0.15607093543408807 0.14164169462099521 -0.014976737516259673 0.02521309209862908 0.1613322276383225 0.035502779963563776 0.044868870314575336 0.11651918302584514 0.36612129996363668 0.35754567880261345 0.46742490947711518 0.084871674895513449 -0.23008819787328125 -0.29764501493401874 -0.17084238706092875 -0.094063011905783464 -0.08017399589212168 0.18842008122193502 -0.011577341425628305 0.01483973446684006 -0.12272648098080656 0.22363888028934326 0.09032417424800443 0.012499751477486377 0.022139335078817702 0.32071043965725254 0.3295743749067761 -0.050785340163272824 0.1340530062809423 0.43731833745403592 -0.091753974769433033 -0.15892144162345653 -0.16170321773613802 0.038236629486616602 -0.082542626135538755 0.11324237717585964 0.16517846673230213 0.059078630254759006 0.23388613260170993 -0.088394765552014601 -0.22696502340066568 0.23971783983914069 0.16098728092899217 0.33297508434783035 0.11189049920764323 0.25140351234727654 0.63581629561375663 0.14328700822405366 0.087607973957041507 -0.1787244029286095 0.16046914548646798 0.063500767814756956 -0.12585203568793196 -0.21925675348994944 -0.20097997502288581 -0.06355638119246583 -0.044984222269441258 -0.32895817496048746 0.13512721045792964 0.37947377811877891 0.15582312189746239 0.18389731255503122 -0.099916878139971854 0.40088379911659278 -0.21868903541352849 0.16883139774044206 -0.11073904257527101 -0.07616839368116203 -0.009799621212564438 -0.046278228433008856 -0.1036002965699851 0.08991632890827074 -0.12780096399541319 -0.0038174337897187941 -0.091016992293814741 -0.23351953749672044 -0.38739851520222168 0.012637194921709114 0.022552326863111052 0.12711134689944603 0.15908757424460357 0.15439272482072383 0.33887358182857447 -0.1594627129839038 0.12734599891217668 -0.21098973363018569 0.12670197291597196 0.26515466731148873 0.15715591578445132 0.085274858518209082 0.078585610300015152 0.028713883778968552 -0.26814815167243039 -0.4142966156484903 0.056449142869322559 0.069580101267949335 0.36951510767750584 0.1892195379423553 0.19278052478680313 0.112700727274286 0.10017269949591598 -0.31959049244766957 -0.28285278544840725 0.077851688684735243 0.017307669717634578 0.045880401036940271 0.16235700219320182 0.033156600267185296 -0.24490468278647767 -0.42503243518078093 -0.54767333137317753 -0.26465649479151548 0.20093167596523406 0.17602522685365246 0.011085326260278666 0.030747276072637043 -0.0039886352119838158 -0.19160228321818157 -0.19764884306489908 0.065330486070414792 -0.13393239568835152 -0.0021153216222056575 -0.011656197609312616 0.17548298861197786 0.34462981376699431 -0.19772136481969654 -0.3928325616284678 0.063969139376696807 -0.12900579809138538 0.12535212881568344 -0.033577616199308144 0.097794009237562582 0.1978588555189344 0.036562483128192325 -0.16687075753712699 0.035755926611321751 -0.18162315201568205 -0.032052587476709742;-0.24087459180019608 -0.16572639064625919 -0.12668480628110868 0.13576651621008748 0.10186958472326035 -0.0041605311408879873 0.13098409830394772 -0.033756001948519729 0.21821480434130217 0.30355424316704482 0.32011766584450024 0.12024902435967755 -0.31058902108948366 -0.33381300801618669 -0.088289748682943189 -0.1053146199607531 0.034189747976425759 -0.069525474126979014 0.14172830425772814 0.060463699389677626 0.065853333530272909 -0.013469706440605881 0.30737874203853899 0.059071421027070331 0.10081327214314187 0.09136645221523125 0.5039630810968545 0.049837997617328281 0.24070965341360456 0.042297333651441622 -0.37696672336500975 -0.41235054387285985 -0.18426596565396877 0.1267451913295769 0.23484419621137431 -0.19742758109779188 -0.19604623465657989 -0.36019172594628152 0.14290916776620063 0.088464333941781159 0.022700084281088131 -0.054253816450345847 0.13076610531463226 0.38666767265962998 0.34097698206491689 -0.23521488413350566 -0.010917821874773666 -0.31725149834527694 -0.32843631138710727 -0.36174085105391163 -0.19561239755081594 0.16929312263034552 -0.071270771994815824 -0.4695342523571337 -0.12058821786745845 0.17224179967238545 0.260988187041168 0.17838281170586789 0.0077657836427869036 -0.41828918326525044 0.24654021733192941 0.26928208707341872 -0.23527085559349617 -0.34992495955313174 -0.10881599806401775 -0.2406836604093078 -0.070321330549536418 0.11464752854236764 -0.1244300957290279 -0.16985238670954841 -0.14529876795921659 -0.03061336152449342 0.45539221025506882 0.097993877622126857 -0.1825593179786526 0.084688639252099712 -0.1904761722259907 0.17606366182939961 0.002854383417308246 0.036396421510635643 -0.1168231411547825 0.25522655418220885 -0.13107956023271389 0.056810364807641282 0.032157349679014201 0.062611425693886461 -0.027635582694983542 -0.098370541857836821 0.092375644953237315 0.37780689649185273 0.28336432253998711 -0.061457071171955223 0.14358457563884794 -0.19087389528707843 0.19725656323225707 0.41253644010653256 0.37751737274993619 0.036521968498004431 0.37750785590695579 0.039115088615554593 -0.090615537725036235 0.15625090910644382 0.16732809941973631 -0.29454917998851987 -0.13181875701774767 0.1055924092056237 0.15726168205532154 0.17710394089654716 -0.20289925177715182 -0.22889175391358596 0.01386393907172999 -0.13434952113266635 0.39353242577810388 -0.052388834159244953 0.10266957433981629 0.34368592313742558 -0.37026698053429741 -0.17378021350946854 0.015007233482766377 -0.10125352194098046 -0.2017412768121673 -0.37675499732635814 -0.10085115881622596 0.33980341375508588 0.32075686600445963 0.22399492181057562 0.025519575245171511 0.084068245903510239 -0.22853959821765729 -0.058379956600726798 -0.2158414968000886 -0.12193929441911405 -0.20710202500965313 -0.18833044766655765 0.039657754030256648 -0.13185749042463615 0.047458049074813061 -0.097743134703674933 -0.26897771908302903 -0.067068615966285106 -0.018363987071359035 0.36194314478062167 0.37885808911738283 0.10868082515889499 0.21094448008963501 0.15696434504908541 0.06259720899488383 -0.28678337612540117 0.0035862328490494921 0.08785161751356596 -0.33563033750162757 0.0081698053825289656 0.067685554460178307 -0.14890702967281899 0.068058802668236981 -0.17319513499381881 -0.041580917649876439 0.12859270272799864 0.0044501445652193753 0.21578294570103365 0.11403338739071067 0.26673913597045357 -0.077874186336934534 -0.011902419922480882 0.046911431361280266 0.0024508203401576163 -0.19096855842981136 -0.048367255569649444 -0.14464821586291726 0.21570404195313986;-0.27495046972569803 -0.10511194728477292 0.18892079605414036 0.19739646752316664 0.056702234821675156 0.18650178927616115 0.014423419741778675 -0.045034211984064348 -0.23406030339619402 -0.15802225832565192 -0.30392716232314959 -0.16320372983294454 0.083505128058756248 -0.17673714195584947 0.10271191052060777 0.16656942773113997 -0.16838405368746298 -0.22055423604884114 0.018256365846933992 0.30780321744921862 0.24493324395917954 0.063627476998971824 -0.047341851719132334 0.16636127894450836 -0.045240738604673661 -0.3502263441993449 -0.067205205321943032 -0.0098270043928508546 0.15675017797408114 0.31942342601782636 0.16010104892393653 -0.08593801284508272 -0.10299512961864281 0.046056432244280812 -0.081181641118408213 0.13745983517587351 0.39632887274271084 0.18466320311727133 0.1401643360762275 0.25267091564800931 0.63415952040450452 0.32450717007534624 0.08503698257123464 0.12286456663737604 0.20113018966072552 0.34783246733734247 0.02299778499575859 0.063689444517403937 -0.083981251494810033 -0.12173625436934328 0.063775324249701851 0.091440102303089882 0.12820590641964708 0.28309547128076673 -0.015239347701532478 -0.032980121762656078 0.26399540102814251 0.0056086434847271837 0.37763563449751419 0.12076845152655404 0.43813318329687495 -0.14404342960894823 -0.056379084785570049 0.080641231817628473 0.12530893091411999 0.26071764637907263 0.14458052754820019 -0.12485589402003817 -0.020853136484776293 0.26253811541305083 -0.012228251640807399 -0.1889135215075767 -0.2989652179830225 -0.30784654965206804 -0.2449195724011882 -0.10001622144631038 0.15668026653536193 0.3288597293320476 -0.40918070568789183 -0.29699261808019206 0.22101227262340312 0.054619596809307044 0.045081218647882802 -0.044816009776267166 -0.064671498828922785 -0.0011127173300683739 -0.02224796704943879 0.015586939001783782 0.15052591271896218 -0.27876866966107072 0.0042937005215024689 -0.057701043475659096 -0.098834930624017409 0.072533319185266079 -0.12950386845132447 -0.18419637593966798 -0.12774621181298776 -0.097750325676855515 -0.032331624327894659 -0.097745240365683494 -0.06063988426612401 0.27886030617773894 -0.1043875262216722 0.012181850636773678 0.10304885165950291 -0.20517908630856688 -0.05249940878096282 0.019181415953943654 -0.19798362684935855 -0.43504819399834271 -0.46295223812188552 -0.15813244122639972 -0.13463869210857443 -0.2814761409346036 -0.00034905111773370719 -0.10058689577200025 -0.2218669233260909 -0.23032909740681826 0.0047133300205280289 0.0053563224044854054 -0.026260535586814113 0.29193162603969131 0.18585762339325118 -0.35338446038928079 0.10565421853237297 -0.0017808160424512957 0.038037394131683784 -0.2503723627516346 0.07064366486179563 0.081910350377493793 -0.29830616991548309 -0.2896420853439382 -0.15979023962068148 -0.069084014296604157 0.0041148218275655207 -0.0068579431668177281 0.142698532321588 0.065412708972826916 0.18089669741348124 0.22479294385914106 -0.15886095201112996 0.10972130631365662 0.32548933691654758 0.047795337123674488 -0.14972769188098342 -0.22181509613506575 -0.10910430235293767 -0.3502898652459166 -0.16056304919274328 -0.25832347642094738 -0.3077488350436981 -0.10594196862753304 -0.093025332738522773 0.071873022111855173 -0.26100813521555966 -0.0082690850887197735 0.095980761119561206 -0.01545945682868345 0.014013961618903972 0.022256008538010671 0.040174570848084831 0.19704478220409197 0.046227954156093813 0.19288262279454105 -0.16706091710798593 0.2814065648940447 0.1597457206535691 -0.016977882742513894 0.023665860178542823 -0.099618716787392564;0.002817574078127336 -0.20537223806484053 -0.11171463742069968 0.1966196499580834 0.003396516035423112 0.034983989075912103 0.096998086457037655 0.035116314056793739 0.09481717528048636 0.14896173639875165 -0.082926494145107332 0.13663247774515705 0.33755591616769165 0.15161485923501924 -0.30440120407021359 0.14271240158222556 -0.085656402516254282 0.1282918345909522 -0.22129923344484209 -0.24788219380632504 -0.23022941571515587 -0.32119696343518417 -0.096914157376391183 -0.25518149735063878 0.013232860035967065 0.25490888412960222 0.15855493362597561 0.25448534118383048 -0.11013027483757229 0.093946997891655976 -0.015287098835252776 -0.064995334605173913 -0.17616380048633504 0.10306314899371052 -0.0098716504824347961 -0.026531901642414001 -0.10395191306397301 0.10080935576255219 -0.07055311527439663 -0.3337575047661408 0.01163508862958593 0.17988497496152786 0.2335178509427501 0.010841770150607591 0.34281109358000372 -0.068506782817402051 -0.066619838012401775 -0.24685767236203648 0.061191427569425583 -0.070454769826415339 -0.153778237619384 0.032155973467936617 -0.16573667556533439 -0.19649943565859543 0.29579785180601775 0.04429760148024818 0.16842815945864786 0.14192498247114654 0.036465280282676413 0.2512201566422349 -0.061116173356529128 0.12282650958657743 0.046379478102834847 -0.026220515558744446 -0.21938999559811512 0.13734753571105532 0.055689815910331453 -0.036884255661390655 0.14840382332625665 0.063364337543947769 -0.17733830883928375 0.19066366952125358 -0.06163365164812365 0.20047092737536495 0.12662006456261685 -0.083696878469504479 0.099852915072551604 -0.033639967055923987 -0.33244689473948563 -0.24176365944687236 -0.22268451276394738 0.096688786156726048 -0.12376333058871382 0.13053732050012809 -0.10521138213196363 -0.14909942126942446 0.064389472160691186 0.051989659096111591 0.044048729436839469 -0.23340985162336489 -0.048256889646733303 -0.0099146380916724491 -0.14412143983814829 -0.020390873214959498 -0.1108973215999312 -0.22657495096209168 0.17416429092788524 0.11612998763288757 -0.039506884942287622 -0.095563956106390971 0.077080438239728433 -0.19979340680255728 0.067960264863695247 0.19879250465203341 0.093870463805562451 -0.19551440438723017 -0.18044659022535495 -0.13766078774939389 -0.071038679049646031 0.33869041010057843 0.1910624595951648 0.031913087527444803 0.053012582629982222 0.19790040406483617 0.085787397244544122 0.017801852191636294 -0.07542963584228736 -0.078395526093969978 -0.039397395979806078 0.13616624749257628 0.060222555470829928 0.13340802042955832 0.075622876434200653 -0.30160416769875298 -0.28144760936379554 -0.20545221203522407 -0.01103707720696993 0.18914368363691902 0.014116567021632788 0.47644863106094737 0.61068542105175894 0.20052077277174965 0.19918757679022661 -0.0015456134380757176 -0.071088208117827845 0.00060019244266827155 -0.069291052619031748 0.06030677774292699 -0.11402856111095569 0.017725345342510287 -0.071755133924259293 0.056410864794071321 0.09325117354043877 -0.16572616270679391 0.061477592652432689 0.095618498653304143 0.43096452219217313 0.339851330500889 0.37790342019691553 0.30518782231271041 -0.083355051464642033 0.12389532037756824 0.095169942703154986 -0.116549603518735 -0.050768130114384483 0.12022583783638226 -0.033201346019150604 0.013367199390845751 -0.21768336878351097 -0.020940242049550022 -0.053391362015843033 -0.23282366960832071 0.23481245094912401 -0.0091114692447489525 -0.042919549607118981 0.33281398306068743 0.17953935556428616 -0.1883425078574828 0.0062404439883707585 0.034585767392418115;-0.073349978384715742 0.23947960651807937 0.027031585316770985 0.26648517557658713 0.16915671371223912 0.27609640904803295 0.38182115105630804 0.19851730108845478 0.24897406955360341 0.29276143564384399 0.29405236065199553 0.12002260662448748 0.04463103894510613 0.11462299719760595 0.050427497190889403 -0.07407372149712646 0.085901683819464086 -0.21551664400803033 -0.061427756062021152 0.18841822657095508 0.2230643127255359 0.11480030049991018 0.3317844735085847 0.33948984064345183 0.35242408497272598 0.12572216506574233 0.46855129625284875 0.88562434033538073 0.43327716785138709 0.32400902007067656 0.21529789886308245 -0.028915935569616746 -0.052870254968401476 -0.042220997855901193 -0.12762668182404108 0.16923225291706426 0.19371573050716315 -0.054461834323119768 -0.024752465624953458 -0.051113052453980963 0.20913608893690416 0.09134686418569489 0.086402529150799268 -0.056767843302134059 0.1753683689316588 0.15866123064264676 0.07623906658759716 -0.27094095853354411 -0.12045044792691721 0.16745237485765924 -0.076083040968285789 -0.036073232195162071 0.11523302563389889 0.098002110655532507 0.027110162271085553 0.073284256613468893 -0.28007320422053661 -0.26475346105598546 0.30389218236908311 -0.070062679677460299 -0.18304015133178289 -0.25646470922304732 0.088855699731116553 0.3542815928914288 -0.14487334551684317 -0.1929972459007101 0.074031866997270102 -0.10004896671949327 -0.15773460054725905 -0.12640213724805946 -0.058283364745022076 0.025477943533743611 -0.039597210759840892 -0.27067373742781398 -0.13163139449792652 -0.067889588485974095 -0.10568709563303852 -0.21896305731990504 -0.38947954026149767 -0.205241046551186 0.18704233255937805 0.14369497619232782 0.13481888385754584 0.082431030151225243 0.030648572698749765 0.1223437071545979 0.21042556025648779 -0.10852195925739284 -0.16203328632266695 0.079941514795491789 -0.25438647494145389 -0.01301755361095743 -0.085015353833072696 -0.17908733193777018 -0.32525457937320668 -0.46456230329941844 -0.15652769840591813 -0.23498809651269711 -0.13623988432791198 0.022836839261912933 0.045221134821829816 0.147318507567642 -0.13217696636668141 0.064607773782489608 0.25743600821121715 -0.13301805190050192 0.29438238341566242 0.23804788174149039 -0.20250153249052685 -0.12647599299671614 -0.29833068940966967 -0.31193038080853819 -0.05915841759916661 -0.41713890664704673 -0.37783437824307647 -0.03777958748450426 -0.21081072883152779 0.061937767262093837 -0.071881962986215214 0.012005456735849761 -0.17367010858010121 0.20740125350926489 0.10889261112094636 0.27203873123774081 0.16133339916804443 -0.033002583646733592 -0.036621398998959366 -0.11559891523680867 -0.304292572464199 -0.43541136310696904 -0.16571925289714848 -0.046967432494181192 0.12226362582857964 -0.059161420553956588 0.026086428095523626 0.074907993338174272 0.01926112588041453 0.20398525009578544 -0.0095034705785257481 0.35174237094052219 0.37190910958408879 0.073038752436288143 0.061793317238872811 -0.10822300779174425 -0.2216639990026133 -0.36159256451665422 -0.34810209242752482 -0.48047338737203826 0.10367383801156248 0.20207470497549229 0.26274290805980771 0.090416855734859733 0.20492998259347131 0.10449559225638841 0.01167339007764011 -0.12239731408043028 -0.17134357921140131 0.017784678399124006 -0.12599037375603223 0.037860741306294653 0.14034371415746888 0.0011125855725923187 0.21747856297010842 -0.047668158805710521 -0.034261141020264646 -0.1573860780222078 0.07577100706318278 -0.024507045230572351 -0.14812459331200764 -0.037246316058520391;-0.15061463379669815 -0.091647764079451272 -0.10761891188477801 0.17615606562777664 0.056896991658639602 0.23969845632497042 -0.02004483902711747 0.11740387047263398 -0.25561166673824398 -0.071911188125219183 0.092615397570199043 0.15900621075083016 0.30761537788510984 -0.32797851962894231 -0.26031817767966087 -0.24723434442083306 -0.20477517513373214 -0.021917443215984378 0.056310543620827332 -0.090909512588581542 0.18160421543871946 -0.017611215960636827 0.18560199596743038 -0.17385411910095042 -0.18300295835146077 -0.059986066757062709 0.27897877948101829 0.035871304146802008 0.12419384502508696 0.280155748899093 0.053021123639959006 -0.25737679424955373 0.14149124019130943 0.11977136904783824 0.046721193226839958 0.12646559029347923 0.0060391929895308935 -0.17076415974279319 0.18656376337150918 0.092602699549214185 0.054999484562842517 -0.38647712679546686 0.25336378796137698 0.46727689432716141 0.29896736196330453 -0.0017859231652446027 0.14241769736609361 -0.058991027195514904 -0.059368158037618753 -0.23795011750138439 -0.1627861386923305 0.17060037273729212 0.18755584336224204 -0.0559829765557266 0.16884644808235083 -0.24179437274033883 -0.07484191358960747 0.013261500841243447 -0.040597247752199687 0.089027576647828344 0.37098553760099012 0.13487981088901568 -0.060258501908636151 -0.26788578731942209 0.0043372012503860415 0.11546847277572114 -0.027644020694019264 0.013335713514467912 0.1017741754880821 0.36568335037146832 0.0098541464848695103 -0.1694254636183542 -0.14215902184904092 -0.17722042299715129 -0.20428592587580202 0.091427101146973305 0.19906448829532045 -0.034283673230924856 -0.088845835783157828 -0.087848001290939601 -0.1282570041721155 0.083370893241332705 -0.014645631811841101 0.14166721749506977 -0.22080836408151036 0.096459864404490669 0.060564666541548164 -0.16600882010510734 -0.1611036340500355 -0.15491098344340443 0.18562822724370132 -0.20467283488897461 -0.14440961947606307 -0.15161972576157109 -0.074154569721018082 -0.10350507859629483 0.13692855353784197 0.18655854977298281 0.0043206595454434197 0.065016452409971864 -0.21989449070907577 0.11112576280162205 0.14989601099753969 0.15778804436073132 -0.15790409273339667 -0.38137213096081246 0.15031530520843298 0.37889018490723447 0.14226193259864142 0.14531730120503933 -0.090836418998687565 0.12903159406626535 0.33896775965385717 0.13244474198417139 -0.013075284402821229 0.10522925063470853 -0.11279129753167769 -0.062800784382907746 0.1949566804807053 -0.036036004692662715 0.00089130726991893013 -0.19431214164513919 -0.32064661716814902 0.2039993766301417 0.55116549515953905 0.65253026551185456 0.2012097069766558 0.18153310745582144 0.058907415218187507 0.22395138380140778 0.2043048619879568 0.15663536609250209 -0.075349870940112001 -0.12549048769189941 0.098113442396496747 0.052340546796171006 -0.15477358120581805 0.086113084768771483 -0.14536359160073639 -0.23735292826147433 -0.11589222538510047 0.22234185452036434 0.21377539386327449 0.077196996715940949 -0.0024140950739083202 0.09716176626051011 0.26064784106673938 0.31632679551248866 0.12383369215062313 0.15553192761579462 0.023306293978898683 -0.20085338209330203 -0.16895595716272496 -0.098742946146420957 0.0023945507807842121 -0.20006017081348909 -0.090077960273946073 0.2025150507582214 0.28109623665294281 0.018788745719493079 0.18487497273571077 0.014659366333837073 -0.17675863664326816 -0.033462538759752247 0.12071860466825877 0.022356894376217691 0.20327583705891744 -0.15240290317710087 0.14129297690739429 -0.064129555115675932];

% Layer 2
b2 = [-0.62918840405371923;0.4548644621783442;-0.26783788977825002;-0.53975355478104003;-0.19050568354936684;-0.27459936696420517;0.23009841136222772;0.25550531231342133;0.73734790140750195;0.4531240712788388];
LW2_1 = [0.3302539858964072 -1.4148093781728159 -1.4936313045147567 -0.7706045088016471 1.5926210537586816 -0.53644945732666283 -0.64551835278516356 0.14664055586374253 -1.4130786151729331 -0.26733031631935139;-1.1593116524694824 -1.3096314362526436 -0.13326157247161791 -0.17529676391705784 -0.1485197623779258 -1.4033744554556964 0.17746049460328167 1.0479887375124459 0.64626765932777064 0.5738143303070502;0.26203343758964992 0.7917507550984938 -0.96226898331860178 0.6330487966635191 1.1929585787458539 0.44835725506723451 0.48022392065090252 1.6858073119721446 -0.75437701221186426 1.0281845368742992;0.35926239694851386 -1.1194141266724877 0.039119589716815624 1.8611346302429994 0.87441042072498287 0.76725689010890308 0.84889252803408888 -1.2293083728462086 0.44921831249384897 -0.27785616229852;-0.80017188959745567 -0.10485234828033885 2.0302325246354318 -0.2686997380916194 -0.20200477969400069 0.1880904267639123 1.7812703267938059 -0.33474670874677642 1.6524244505739865 -0.35850673659675375;-0.84183207199336962 0.72052092724208661 -0.073805466036046596 -0.64611462135016906 -1.4620167601507865 1.6210862373012371 0.13125644901030023 -1.1775826623010925 0.95181573268124564 0.72484071931241101;1.4272229371136831 0.85871359941224312 1.0252257180647526 -0.0069315761744595684 -1.0494251120478637 0.21344297229024292 0.76248600603395777 -0.43960793735732662 -1.4287703217884109 0.87394913247244976;0.35582462254386288 0.00031603995502733385 0.60525652493053028 0.70345929863810797 -0.634443412121795 1.2291529900099631 -0.92855137048753755 0.8689913048356428 0.65390742139371905 1.0108766959949209;-1.4277087774544652 1.1500755261824629 0.62588924082523067 0.22666462844578594 0.77331687022785012 -0.50041759884741255 -1.0887785958632958 0.18586262383829608 -0.79304061066477716 -1.1312051971314101;-0.3514140892768588 0.055724936251171371 -1.4873324287663663 -0.45904119424836337 -0.99417493915094579 -1.2182361388298231 0.36579839987050705 -0.0025507820092701174 0.42103056828215213 -1.229520728102294];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Output 1
    Y{1,ts} = a2;
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n,~)
if isa(n,'gpuArray')
    a = iSoftmaxApplyGPU(n);
else
    a = iSoftmaxApplyCPU(n);
end
end
function a = iSoftmaxApplyCPU(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numerator = exp(n);
denominator = sum(numerator,1);
denominator(denominator == 0) = 1;
a = bsxfun(@rdivide,numerator,denominator);
end
function a = iSoftmaxApplyGPU(n)
nmax = max(n,[],1);
numerator = arrayfun(@iSoftmaxApplyGPUHelper1,n,nmax);
denominator = sum(numerator,1);
a = arrayfun(@iSoftmaxApplyGPUHelper2,numerator,denominator);
end
function numerator = iSoftmaxApplyGPUHelper1(n,nmax)
numerator = exp(n - nmax);
end
function a = iSoftmaxApplyGPUHelper2(numerator,denominator)
if (denominator == 0)
    a = numerator;
else
    a = numerator ./ denominator;
end
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
